---
title: "Analytical Plan for Study design for the association between peak troponin levels and post-surgery mortality in an Australian hospital"
subtitle: 'DOCUMENT: SAP-2022-019-v01'
author: '**From:** Felipe Figueiredo **To:** green_trader (fiverr.com)'
date: "`r Sys.Date()`"
output:
  html_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 6
    keep_md: yes
    number_sections: yes
    toc: yes
  pdf_document:
    number_sections: yes
    toc: yes
  word_document:
    fig_caption: yes
    fig_height: 6
    fig_width: 6
    reference_docx: misc/style_SAP_en.docx
    toc: yes
# toc-title: "Sumário"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = normalizePath(".."))
options(scipen = 999)
library(pander)
library(knitr)
panderOptions('table.style', 'rmarkdown')
panderOptions('table.split.table', 160)
```

---

\newpage

**Analytical Plan for Study design for the association between peak troponin levels and post-surgery mortality in an Australian hospital**

**Document version**

```{r history}
Version <- c("01")
Changes <- c("Initial version")
history <- cbind(Version, Changes)
colnames(history) <- c("Version", "Alterations")
# pander(history, split.cells = 70)
kable(history)
```

---

# Abbreviations

- CI: confidence interval
- HR: hazards ratio
- ICU: Intensive care unit
- SD: standard deviation

# Context

## Objectives

Study design for the association between peak troponin measurements and in hospital mortality adjusting for scores on EURO scores and APACHE.

## Hypotheses

## Study design

Prospective cohort.

# Data

```{r cleaning, include=FALSE}
source("scripts/input.R", encoding = 'UTF-8')
```

## Raw data

Upon study start the raw data will be collected in a raw table, that will be processed before analysis.
The raw dataset to be collected will have
`r Nvar_orig`
variables collected on
`r Nobs_orig`
observations.

This dataset will include the dates of entry and exit of the cohort, or the date of hospital admission and the date where the endpoint was reached (either an event, or hospital discharge).
Table 1 shows the structure of the raw dataset.

```{r analytical data}
analytical_mockup %>%
  pander(caption = "**Table 1** Raw dataset structure.")
```

Each row represents all information collected from each study participant, and each participant included will require an unique study ID.
The outcome should be recorded as a binary variable: either the study participant reached the endpoint (death) or survived and was discharged.
This information can be recorded in either text form, or an indicator (death = 1, discharge = 0).

Surgery length should be recorded in minutes, and ICU length in days.

## Analytical dataset

The analytical dataset will be created by cleaning the raw data and applying the study's inclusion and exclusion criteria.
Time under observation will be calculated in days from the dates of entry and exit of the cohort.

The total number of observations excluded due to incompleteness (missing data) and due to exclusion criteria will be reported in the analysis.

<!-- After the cleaning process -->
<!-- `r Nvar_final` -->
<!-- variables were included in the analysis -->
<!-- with -->
<!-- `r Nobs_final` -->
<!-- observations. -->
<!-- After the cleaning process -->
<!-- `r Nvar_final` -->
<!-- variables were included in the analysis. -->

All variables in the analytical set will be labeled according to the raw data provided and values will be labeled according to the data dictionary for the preparation of production-quality results tables and figures.

# Study parameters

## Inclusion and exclusion criteria

Inclusion and exclusion criteria will be defined in the study protocol.

## Exposures

Peak troponin levels, measured as a continuous scale.

## Outcomes

**Specification of outcome measures** (Zarin, 2011):

1. (Domain) Mortality
2. (Specific measurement) In hospital death counts
3. (Specific metric) Time to event
4. (Method of aggregation) Hazards ratio

**Primary outcome**

In hospital mortality rates after 30 days.

## Covariates

Hazard ratios will be adjusted for Euro score, APACHE score, type of surgery, length of surgery and length of ICU stay.

# Statistical methods

## Statistical analyses

### Descriptive analyses

The epidemiological profile of the study participants will be described.
Demographic
(sex, age and BMI)
and clinical variables
( EURO score, APACHE score, type of surgery, length of surgery and length of ICU stay )
will be described as
mean (SD)
<!-- median (IQR) -->
or as counts and proportions (%), as appropriate.
The distributions of participants' characteristics will be summarized in tables and visualized in exploratory plots.

### Inferential analyses

<!-- All comparisons between groups will be performed as univariate analyses. -->
<!-- Continuous variables will be compared between groups with the -->
<!-- independent t test with Welch correction. -->
<!-- paired t test. -->
<!-- Wilcoxon test. -->
<!-- Differences in distribution of categorical variables will be assessed with the -->
<!-- Fisher exact test. -->
<!-- chi-square test. -->
<!-- McNemar test. -->

All inferential analyses will be performed in the statistical models (described in the next section).
Survival rates and time to event will be reported, with their respective CI.

### Statistical modeling

Hospital mortality will be evaluated with a Cox regression model.

Two models are planned to be created to evaluate the impact of the troponin levels in mortality.
A simpler univariate model including only the exposure will be created to serve as a base of comparison for the main model.
The main model will adjust the HR between mortality and troponin levels by controlling for the type of surgery, surgery length, ICU length of stay and the risk scores APACHE and EURO.

### Missing data

No missing data imputation will be performed.
All evaluations will be performed as complete case analyses.

## Significance and Confidence Intervals

All analyses will be performed using the significance level of 5%.
All significance hypothesis tests and confidence intervals computed will be
two-tailed.
<!-- left-tailed. -->
<!-- right-tailed. -->

## Study size and Power

The study protocol defines an intended sample size of 200 patients.

## Statistical packages

This analysis will be performed using statistical software `R` version `r getRversion()`.

# Observations and limitations

# References

- **SAR-2022-019-v01** -- Study design for the association between peak troponin levels and post-surgery mortality in an Australian hospital
<!-- - Cohen, J. (1988). Statistical power analysis for the behavioral sciences (2nd Ed.). New York: Routledge. -->
- Zarin DA, et al. The ClinicalTrials.gov results database -- update and key issues. N Engl J Med 2011;364:852-60 (<https://doi.org/10.1056/NEJMsa1012065>).
- Gamble C, et al. Guidelines for the Content of Statistical Analysis Plans in Clinical Trials. JAMA. 2017;318(23):2337–2343 (<https://doi.org/10.1001/jama.2017.18556>).

# Appendix

This document was elaborated following recommendations on the structure for Statistical Analysis Plans (Gamble, 2017) for better transparency and clarity.

## Availability

All documents from this consultation were included in the consultant's Portfolio.

<!-- The client has requested that this analysis be kept confidential until a future date, determined by the client. -->
<!-- All documents from this consultation are therefore not published online and only the title and year of the analysis will be included in the consultant's Portfolio. -->
<!-- After the agreed date is reached, the documents will be released. -->

<!-- The client has requested that this analysis be kept confidential. -->
<!-- All documents from this consultation are therefore not published online and only the title and year of the analysis will be included in the consultant's Portfolio. -->

The portfolio is available at:

<https://philsf-biostat.github.io/SAR-2022-019/>
